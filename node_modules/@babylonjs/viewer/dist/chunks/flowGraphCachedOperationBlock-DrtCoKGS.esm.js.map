{"version":3,"file":"flowGraphCachedOperationBlock-DrtCoKGS.esm.js","sources":["../../../../../dev/core/dist/FlowGraph/Blocks/Data/flowGraphCachedOperationBlock.js"],"sourcesContent":["import { FlowGraphBlock } from \"../../flowGraphBlock\";\nimport { RichTypeBoolean } from \"../../flowGraphRichTypes\";\nconst CacheName = \"cachedOperationValue\";\nconst CacheExecIdName = \"cachedExecutionId\";\n/**\n * A block that will cache the result of an operation and deliver it as an output.\n */\nexport class FlowGraphCachedOperationBlock extends FlowGraphBlock {\n    constructor(outputRichType, config) {\n        super(config);\n        this.value = this.registerDataOutput(\"value\", outputRichType);\n        this.isValid = this.registerDataOutput(\"isValid\", RichTypeBoolean);\n    }\n    _updateOutputs(context) {\n        const cachedExecutionId = context._getExecutionVariable(this, CacheExecIdName, -1);\n        const cachedValue = context._getExecutionVariable(this, CacheName, null);\n        if (cachedValue !== undefined && cachedValue !== null && cachedExecutionId === context.executionId) {\n            this.isValid.setValue(true, context);\n            this.value.setValue(cachedValue, context);\n        }\n        else {\n            try {\n                const calculatedValue = this._doOperation(context);\n                if (calculatedValue === undefined || calculatedValue === null) {\n                    this.isValid.setValue(false, context);\n                    return;\n                }\n                context._setExecutionVariable(this, CacheName, calculatedValue);\n                context._setExecutionVariable(this, CacheExecIdName, context.executionId);\n                this.value.setValue(calculatedValue, context);\n                this.isValid.setValue(true, context);\n            }\n            catch (e) {\n                this.isValid.setValue(false, context);\n            }\n        }\n    }\n}\n//# sourceMappingURL=flowGraphCachedOperationBlock.js.map"],"names":[],"mappings":";;;AAEA,MAAM,SAAS,GAAG,sBAAsB;AACxC,MAAM,eAAe,GAAG,mBAAmB;AAC3C;AACA;AACA;AACO,MAAM,6BAA6B,SAAS,cAAc,CAAC;AAClE,IAAI,WAAW,CAAC,cAAc,EAAE,MAAM,EAAE;AACxC,QAAQ,KAAK,CAAC,MAAM,CAAC;AACrB,QAAQ,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,kBAAkB,CAAC,OAAO,EAAE,cAAc,CAAC;AACrE,QAAQ,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,eAAe,CAAC;AAC1E;AACA,IAAI,cAAc,CAAC,OAAO,EAAE;AAC5B,QAAQ,MAAM,iBAAiB,GAAG,OAAO,CAAC,qBAAqB,CAAC,IAAI,EAAE,eAAe,EAAE,EAAE,CAAC;AAC1F,QAAQ,MAAM,WAAW,GAAG,OAAO,CAAC,qBAAqB,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC;AAChF,QAAQ,IAAI,WAAW,KAAK,SAAS,IAAI,WAAW,KAAK,IAAI,IAAI,iBAAiB,KAAK,OAAO,CAAC,WAAW,EAAE;AAC5G,YAAY,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,EAAE,OAAO,CAAC;AAChD,YAAY,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,EAAE,OAAO,CAAC;AACrD;AACA,aAAa;AACb,YAAY,IAAI;AAChB,gBAAgB,MAAM,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC;AAClE,gBAAgB,IAAI,eAAe,KAAK,SAAS,IAAI,eAAe,KAAK,IAAI,EAAE;AAC/E,oBAAoB,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,EAAE,OAAO,CAAC;AACzD,oBAAoB;AACpB;AACA,gBAAgB,OAAO,CAAC,qBAAqB,CAAC,IAAI,EAAE,SAAS,EAAE,eAAe,CAAC;AAC/E,gBAAgB,OAAO,CAAC,qBAAqB,CAAC,IAAI,EAAE,eAAe,EAAE,OAAO,CAAC,WAAW,CAAC;AACzF,gBAAgB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,eAAe,EAAE,OAAO,CAAC;AAC7D,gBAAgB,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,EAAE,OAAO,CAAC;AACpD;AACA,YAAY,OAAO,CAAC,EAAE;AACtB,gBAAgB,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,EAAE,OAAO,CAAC;AACrD;AACA;AACA;AACA;;;;"}