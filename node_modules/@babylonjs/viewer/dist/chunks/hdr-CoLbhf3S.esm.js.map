{"version":3,"file":"hdr-CoLbhf3S.esm.js","sources":["../../../../../dev/core/dist/Misc/HighDynamicRange/panoramaToCubemap.js","../../../../../dev/core/dist/Misc/HighDynamicRange/hdr.js"],"sourcesContent":["import { Vector3 } from \"../../Maths/math.vector\";\nimport { Constants } from \"../../Engines/constants\";\n/**\n * Helper class useful to convert panorama picture to their cubemap representation in 6 faces.\n */\nexport class PanoramaToCubeMapTools {\n    /**\n     * Converts a panorama stored in RGB right to left up to down format into a cubemap (6 faces).\n     *\n     * @param float32Array The source data.\n     * @param inputWidth The width of the input panorama.\n     * @param inputHeight The height of the input panorama.\n     * @param size The willing size of the generated cubemap (each faces will be size * size pixels)\n     * @param supersample enable supersampling the cubemap\n     * @param invertY defines if the Y axis must be inverted\n     * @returns The cubemap data\n     */\n    static ConvertPanoramaToCubemap(float32Array, inputWidth, inputHeight, size, supersample = false, invertY = true) {\n        if (!float32Array) {\n            // eslint-disable-next-line no-throw-literal\n            throw \"ConvertPanoramaToCubemap: input cannot be null\";\n        }\n        let stride = 0;\n        if (float32Array.length != inputWidth * inputHeight * 3) {\n            if (float32Array.length != inputWidth * inputHeight * 4) {\n                // eslint-disable-next-line no-throw-literal\n                throw \"ConvertPanoramaToCubemap: input size is wrong\";\n            }\n            else {\n                stride = 4;\n            }\n        }\n        else {\n            stride = 3;\n        }\n        const textureFront = this.CreateCubemapTexture(size, this.FACE_FRONT, float32Array, inputWidth, inputHeight, supersample, invertY, stride);\n        const textureBack = this.CreateCubemapTexture(size, this.FACE_BACK, float32Array, inputWidth, inputHeight, supersample, invertY, stride);\n        const textureLeft = this.CreateCubemapTexture(size, this.FACE_LEFT, float32Array, inputWidth, inputHeight, supersample, invertY, stride);\n        const textureRight = this.CreateCubemapTexture(size, this.FACE_RIGHT, float32Array, inputWidth, inputHeight, supersample, invertY, stride);\n        const textureUp = this.CreateCubemapTexture(size, this.FACE_UP, float32Array, inputWidth, inputHeight, supersample, invertY, stride);\n        const textureDown = this.CreateCubemapTexture(size, this.FACE_DOWN, float32Array, inputWidth, inputHeight, supersample, invertY, stride);\n        return {\n            front: textureFront,\n            back: textureBack,\n            left: textureLeft,\n            right: textureRight,\n            up: textureUp,\n            down: textureDown,\n            size: size,\n            type: Constants.TEXTURETYPE_FLOAT,\n            format: Constants.TEXTUREFORMAT_RGB,\n            gammaSpace: false,\n        };\n    }\n    static CreateCubemapTexture(texSize, faceData, float32Array, inputWidth, inputHeight, supersample, invertY, stride) {\n        const buffer = new ArrayBuffer(texSize * texSize * 4 * 3);\n        const textureArray = new Float32Array(buffer);\n        // If supersampling, determine number of samples needed when source texture width is divided for 4 cube faces\n        const samples = supersample ? Math.max(1, Math.round(inputWidth / 4 / texSize)) : 1;\n        const sampleFactor = 1 / samples;\n        const sampleFactorSqr = sampleFactor * sampleFactor;\n        const rotDX1 = faceData[1].subtract(faceData[0]).scale(sampleFactor / texSize);\n        const rotDX2 = faceData[3].subtract(faceData[2]).scale(sampleFactor / texSize);\n        const dy = 1 / texSize;\n        let fy = 0;\n        for (let y = 0; y < texSize; y++) {\n            for (let sy = 0; sy < samples; sy++) {\n                let xv1 = faceData[0];\n                let xv2 = faceData[2];\n                for (let x = 0; x < texSize; x++) {\n                    for (let sx = 0; sx < samples; sx++) {\n                        const v = xv2.subtract(xv1).scale(fy).add(xv1);\n                        v.normalize();\n                        const color = this.CalcProjectionSpherical(v, float32Array, inputWidth, inputHeight, stride, invertY);\n                        // 3 channels per pixels\n                        textureArray[y * texSize * 3 + x * 3 + 0] += color.r * sampleFactorSqr;\n                        textureArray[y * texSize * 3 + x * 3 + 1] += color.g * sampleFactorSqr;\n                        textureArray[y * texSize * 3 + x * 3 + 2] += color.b * sampleFactorSqr;\n                        xv1 = xv1.add(rotDX1);\n                        xv2 = xv2.add(rotDX2);\n                    }\n                }\n                fy += dy * sampleFactor;\n            }\n        }\n        return textureArray;\n    }\n    static CalcProjectionSpherical(vDir, float32Array, inputWidth, inputHeight, stride, invertY) {\n        let theta = Math.atan2(vDir.z, vDir.x);\n        const phi = Math.acos(vDir.y);\n        while (theta < -Math.PI) {\n            theta += 2 * Math.PI;\n        }\n        while (theta > Math.PI) {\n            theta -= 2 * Math.PI;\n        }\n        let dx = theta / Math.PI;\n        const dy = phi / Math.PI;\n        // recenter.\n        dx = dx * 0.5 + 0.5;\n        let px = Math.round(dx * inputWidth);\n        if (px < 0) {\n            px = 0;\n        }\n        else if (px >= inputWidth) {\n            px = inputWidth - 1;\n        }\n        let py = Math.round(dy * inputHeight);\n        if (py < 0) {\n            py = 0;\n        }\n        else if (py >= inputHeight) {\n            py = inputHeight - 1;\n        }\n        const inputY = invertY ? inputHeight - py - 1 : py;\n        const r = float32Array[inputY * inputWidth * stride + px * stride + 0];\n        const g = float32Array[inputY * inputWidth * stride + px * stride + 1];\n        const b = float32Array[inputY * inputWidth * stride + px * stride + 2];\n        return {\n            r: r,\n            g: g,\n            b: b,\n        };\n    }\n}\nPanoramaToCubeMapTools.FACE_LEFT = [new Vector3(-1.0, -1.0, -1.0), new Vector3(1.0, -1.0, -1.0), new Vector3(-1.0, 1.0, -1.0), new Vector3(1.0, 1.0, -1.0)];\nPanoramaToCubeMapTools.FACE_RIGHT = [new Vector3(1.0, -1.0, 1.0), new Vector3(-1.0, -1.0, 1.0), new Vector3(1.0, 1.0, 1.0), new Vector3(-1.0, 1.0, 1.0)];\nPanoramaToCubeMapTools.FACE_FRONT = [new Vector3(1.0, -1.0, -1.0), new Vector3(1.0, -1.0, 1.0), new Vector3(1.0, 1.0, -1.0), new Vector3(1.0, 1.0, 1.0)];\nPanoramaToCubeMapTools.FACE_BACK = [new Vector3(-1.0, -1.0, 1.0), new Vector3(-1.0, -1.0, -1.0), new Vector3(-1.0, 1.0, 1.0), new Vector3(-1.0, 1.0, -1.0)];\nPanoramaToCubeMapTools.FACE_DOWN = [new Vector3(1.0, 1.0, -1.0), new Vector3(1.0, 1.0, 1.0), new Vector3(-1.0, 1.0, -1.0), new Vector3(-1.0, 1.0, 1.0)];\nPanoramaToCubeMapTools.FACE_UP = [new Vector3(-1.0, -1.0, -1.0), new Vector3(-1.0, -1.0, 1.0), new Vector3(1.0, -1.0, -1.0), new Vector3(1.0, -1.0, 1.0)];\n//# sourceMappingURL=panoramaToCubemap.js.map","import { PanoramaToCubeMapTools } from \"./panoramaToCubemap\";\n/* This groups tools to convert HDR texture to native colors array. */\nfunction Ldexp(mantissa, exponent) {\n    if (exponent > 1023) {\n        return mantissa * Math.pow(2, 1023) * Math.pow(2, exponent - 1023);\n    }\n    if (exponent < -1074) {\n        return mantissa * Math.pow(2, -1074) * Math.pow(2, exponent + 1074);\n    }\n    return mantissa * Math.pow(2, exponent);\n}\nfunction Rgbe2float(float32array, red, green, blue, exponent, index) {\n    if (exponent > 0) {\n        /*nonzero pixel*/\n        exponent = Ldexp(1.0, exponent - (128 + 8));\n        float32array[index + 0] = red * exponent;\n        float32array[index + 1] = green * exponent;\n        float32array[index + 2] = blue * exponent;\n    }\n    else {\n        float32array[index + 0] = 0;\n        float32array[index + 1] = 0;\n        float32array[index + 2] = 0;\n    }\n}\nfunction ReadStringLine(uint8array, startIndex) {\n    let line = \"\";\n    let character = \"\";\n    for (let i = startIndex; i < uint8array.length - startIndex; i++) {\n        character = String.fromCharCode(uint8array[i]);\n        if (character == \"\\n\") {\n            break;\n        }\n        line += character;\n    }\n    return line;\n}\n/**\n * Reads header information from an RGBE texture stored in a native array.\n * More information on this format are available here:\n * https://en.wikipedia.org/wiki/RGBE_image_format\n *\n * @param uint8array The binary file stored in  native array.\n * @returns The header information.\n */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function RGBE_ReadHeader(uint8array) {\n    let height = 0;\n    let width = 0;\n    let line = ReadStringLine(uint8array, 0);\n    if (line[0] != \"#\" || line[1] != \"?\") {\n        // eslint-disable-next-line no-throw-literal\n        throw \"Bad HDR Format.\";\n    }\n    let endOfHeader = false;\n    let findFormat = false;\n    let lineIndex = 0;\n    do {\n        lineIndex += line.length + 1;\n        line = ReadStringLine(uint8array, lineIndex);\n        if (line == \"FORMAT=32-bit_rle_rgbe\") {\n            findFormat = true;\n        }\n        else if (line.length == 0) {\n            endOfHeader = true;\n        }\n    } while (!endOfHeader);\n    if (!findFormat) {\n        // eslint-disable-next-line no-throw-literal\n        throw \"HDR Bad header format, unsupported FORMAT\";\n    }\n    lineIndex += line.length + 1;\n    line = ReadStringLine(uint8array, lineIndex);\n    const sizeRegexp = /^-Y (.*) \\+X (.*)$/g;\n    const match = sizeRegexp.exec(line);\n    // TODO. Support +Y and -X if needed.\n    if (!match || match.length < 3) {\n        // eslint-disable-next-line no-throw-literal\n        throw \"HDR Bad header format, no size\";\n    }\n    width = parseInt(match[2]);\n    height = parseInt(match[1]);\n    if (width < 8 || width > 0x7fff) {\n        // eslint-disable-next-line no-throw-literal\n        throw \"HDR Bad header format, unsupported size\";\n    }\n    lineIndex += line.length + 1;\n    return {\n        height: height,\n        width: width,\n        dataPosition: lineIndex,\n    };\n}\n/**\n * Returns the cubemap information (each faces texture data) extracted from an RGBE texture.\n * This RGBE texture needs to store the information as a panorama.\n *\n * More information on this format are available here:\n * https://en.wikipedia.org/wiki/RGBE_image_format\n *\n * @param buffer The binary file stored in an array buffer.\n * @param size The expected size of the extracted cubemap.\n * @param supersample enable supersampling the cubemap (default: false)\n * @returns The Cube Map information.\n */\nexport function GetCubeMapTextureData(buffer, size, supersample = false) {\n    const uint8array = new Uint8Array(buffer);\n    const hdrInfo = RGBE_ReadHeader(uint8array);\n    const data = RGBE_ReadPixels(uint8array, hdrInfo);\n    const cubeMapData = PanoramaToCubeMapTools.ConvertPanoramaToCubemap(data, hdrInfo.width, hdrInfo.height, size, supersample);\n    return cubeMapData;\n}\n/**\n * Returns the pixels data extracted from an RGBE texture.\n * This pixels will be stored left to right up to down in the R G B order in one array.\n *\n * More information on this format are available here:\n * https://en.wikipedia.org/wiki/RGBE_image_format\n *\n * @param uint8array The binary file stored in an array buffer.\n * @param hdrInfo The header information of the file.\n * @returns The pixels data in RGB right to left up to down order.\n */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function RGBE_ReadPixels(uint8array, hdrInfo) {\n    return ReadRGBEPixelsRLE(uint8array, hdrInfo);\n}\n// eslint-disable-next-line @typescript-eslint/naming-convention\nfunction ReadRGBEPixelsRLE(uint8array, hdrInfo) {\n    let numScanlines = hdrInfo.height;\n    const scanlineWidth = hdrInfo.width;\n    let a, b, c, d, count;\n    let dataIndex = hdrInfo.dataPosition;\n    let index = 0, endIndex = 0, i = 0;\n    const scanLineArrayBuffer = new ArrayBuffer(scanlineWidth * 4); // four channel R G B E\n    const scanLineArray = new Uint8Array(scanLineArrayBuffer);\n    // 3 channels of 4 bytes per pixel in float.\n    const resultBuffer = new ArrayBuffer(hdrInfo.width * hdrInfo.height * 4 * 3);\n    const resultArray = new Float32Array(resultBuffer);\n    // read in each successive scanline\n    while (numScanlines > 0) {\n        a = uint8array[dataIndex++];\n        b = uint8array[dataIndex++];\n        c = uint8array[dataIndex++];\n        d = uint8array[dataIndex++];\n        if (a != 2 || b != 2 || c & 0x80 || hdrInfo.width < 8 || hdrInfo.width > 32767) {\n            return ReadRGBEPixelsNotRLE(uint8array, hdrInfo);\n        }\n        if (((c << 8) | d) != scanlineWidth) {\n            // eslint-disable-next-line no-throw-literal\n            throw \"HDR Bad header format, wrong scan line width\";\n        }\n        index = 0;\n        // read each of the four channels for the scanline into the buffer\n        for (i = 0; i < 4; i++) {\n            endIndex = (i + 1) * scanlineWidth;\n            while (index < endIndex) {\n                a = uint8array[dataIndex++];\n                b = uint8array[dataIndex++];\n                if (a > 128) {\n                    // a run of the same value\n                    count = a - 128;\n                    if (count == 0 || count > endIndex - index) {\n                        // eslint-disable-next-line no-throw-literal\n                        throw \"HDR Bad Format, bad scanline data (run)\";\n                    }\n                    while (count-- > 0) {\n                        scanLineArray[index++] = b;\n                    }\n                }\n                else {\n                    // a non-run\n                    count = a;\n                    if (count == 0 || count > endIndex - index) {\n                        // eslint-disable-next-line no-throw-literal\n                        throw \"HDR Bad Format, bad scanline data (non-run)\";\n                    }\n                    scanLineArray[index++] = b;\n                    if (--count > 0) {\n                        for (let j = 0; j < count; j++) {\n                            scanLineArray[index++] = uint8array[dataIndex++];\n                        }\n                    }\n                }\n            }\n        }\n        // now convert data from buffer into floats\n        for (i = 0; i < scanlineWidth; i++) {\n            a = scanLineArray[i];\n            b = scanLineArray[i + scanlineWidth];\n            c = scanLineArray[i + 2 * scanlineWidth];\n            d = scanLineArray[i + 3 * scanlineWidth];\n            Rgbe2float(resultArray, a, b, c, d, (hdrInfo.height - numScanlines) * scanlineWidth * 3 + i * 3);\n        }\n        numScanlines--;\n    }\n    return resultArray;\n}\n// eslint-disable-next-line @typescript-eslint/naming-convention\nfunction ReadRGBEPixelsNotRLE(uint8array, hdrInfo) {\n    // this file is not run length encoded\n    // read values sequentially\n    let numScanlines = hdrInfo.height;\n    const scanlineWidth = hdrInfo.width;\n    let a, b, c, d, i;\n    let dataIndex = hdrInfo.dataPosition;\n    // 3 channels of 4 bytes per pixel in float.\n    const resultBuffer = new ArrayBuffer(hdrInfo.width * hdrInfo.height * 4 * 3);\n    const resultArray = new Float32Array(resultBuffer);\n    // read in each successive scanline\n    while (numScanlines > 0) {\n        for (i = 0; i < hdrInfo.width; i++) {\n            a = uint8array[dataIndex++];\n            b = uint8array[dataIndex++];\n            c = uint8array[dataIndex++];\n            d = uint8array[dataIndex++];\n            Rgbe2float(resultArray, a, b, c, d, (hdrInfo.height - numScanlines) * scanlineWidth * 3 + i * 3);\n        }\n        numScanlines--;\n    }\n    return resultArray;\n}\n/**\n * @deprecated Use functions separately\n */\nexport const HDRTools = {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    RGBE_ReadHeader,\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    GetCubeMapTextureData,\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    RGBE_ReadPixels,\n};\n//# sourceMappingURL=hdr.js.map"],"names":[],"mappings":"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"}