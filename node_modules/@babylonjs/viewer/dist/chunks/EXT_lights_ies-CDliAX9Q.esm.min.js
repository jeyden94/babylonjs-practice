import{b as e,bu as i,aV as s,T as t,bL as o,bK as n}from"./index-1dDxZ_0d.esm.min.js";import{b as a}from"./objectModelMapping-DtrR_R-D.esm.min.js";import{ArrayItem as l,GLTFLoader as r}from"./glTFLoader-wHGixHtC.esm.min.js";import"./bone-rpjVhoW9.esm.min.js";import"./skeleton-BuLyjIk1.esm.min.js";import"./rawTexture-DNIIHHuO.esm.min.js";import"./assetContainer-Dam1dL5M.esm.min.js";const d="EXT_lights_ies";class h{constructor(e){this.name=d,this._loader=e,this.enabled=this._loader.isExtensionUsed(d)}dispose(){this._loader=null,delete this._lights}onLoading(){const e=this._loader.gltf.extensions;if(e&&e[this.name]){const i=e[this.name];this._lights=i.lights,l.Assign(this._lights)}}loadNodeAsync(o,n,d){return r.LoadExtensionAsync(o,n,this.name,(async(h,m)=>{let _,b;this._loader._allMaterialsDirtyRequired=!0;const c=await this._loader.loadNodeAsync(o,n,(t=>{b=l.Get(h,this._lights,m.light);const o=b.name||t.name;this._loader.babylonScene._blockEntityCollection=!!this._loader._assetContainer,_=new a(o,e.Zero(),e.Backward(),0,1,this._loader.babylonScene),_.angle=Math.PI/2,_.innerAngle=0,_._parentContainer=this._loader._assetContainer,this._loader.babylonScene._blockEntityCollection=!1,b._babylonLight=_,_.falloffType=i.FALLOFF_GLTF,_.diffuse=m.color?s.FromArray(m.color):s.White(),_.intensity=m.multiplier||1,_.range=Number.MAX_VALUE,_.parent=t,this._loader._babylonLights.push(_),r.AddPointerMetadata(_,h),d(t)}));let f;if(b.uri)f=await this._loader.loadUriAsync(o,b,b.uri);else{const e=l.Get(`${o}/bufferView`,this._loader.gltf.bufferViews,b.bufferView);f=await this._loader.loadBufferViewAsync(`/bufferViews/${e.index}`,e)}return _.iesProfileTexture=new t(name+"_iesProfile",this._loader.babylonScene,!0,!1,void 0,null,null,f,!0,void 0,void 0,void 0,void 0,".ies"),c}))}}o(d),n(d,!0,(e=>new h(e)));export{h as EXT_lights_ies};
//# sourceMappingURL=EXT_lights_ies-CDliAX9Q.esm.min.js.map
