{"version":3,"file":"EXT_lights_area-CnOBNWyF.esm.min.js","sources":["../../../../../dev/core/dist/Lights/areaLight.js","../../../../../dev/core/dist/Lights/LTC/ltcTextureTool.js","../../../../../dev/core/dist/Lights/rectAreaLight.js","../../../../../dev/loaders/dist/glTF/2.0/Extensions/EXT_lights_area.js"],"sourcesContent":["import { RawTexture } from \"core/Materials/Textures/rawTexture\";\nimport { Texture } from \"core/Materials/Textures/texture\";\nimport { Constants } from \"core/Engines/constants\";\nimport { Light } from \"core/Lights/light\";\nimport { DecodeLTCTextureDataAsync } from \"core/Lights/LTC/ltcTextureTool\";\nimport { Logger } from \"core/Misc/logger\";\nfunction CreateSceneLTCTextures(scene) {\n    const useDelayedTextureLoading = scene.useDelayedTextureLoading;\n    scene.useDelayedTextureLoading = false;\n    const previousState = scene._blockEntityCollection;\n    scene._blockEntityCollection = false;\n    scene._ltcTextures = {\n        LTC1: RawTexture.CreateRGBATexture(null, 64, 64, scene.getEngine(), false, false, Constants.TEXTURE_LINEAR_LINEAR, Constants.TEXTURETYPE_HALF_FLOAT, 0, false, true),\n        LTC2: RawTexture.CreateRGBATexture(null, 64, 64, scene.getEngine(), false, false, Constants.TEXTURE_LINEAR_LINEAR, Constants.TEXTURETYPE_HALF_FLOAT, 0, false, true),\n    };\n    scene._blockEntityCollection = previousState;\n    scene._ltcTextures.LTC1.wrapU = Texture.CLAMP_ADDRESSMODE;\n    scene._ltcTextures.LTC1.wrapV = Texture.CLAMP_ADDRESSMODE;\n    scene._ltcTextures.LTC2.wrapU = Texture.CLAMP_ADDRESSMODE;\n    scene._ltcTextures.LTC2.wrapV = Texture.CLAMP_ADDRESSMODE;\n    scene.useDelayedTextureLoading = useDelayedTextureLoading;\n    DecodeLTCTextureDataAsync()\n        // eslint-disable-next-line github/no-then\n        .then((textureData) => {\n        if (scene._ltcTextures) {\n            const ltc1 = scene._ltcTextures?.LTC1;\n            ltc1.update(textureData[0]);\n            const ltc2 = scene._ltcTextures?.LTC2;\n            ltc2.update(textureData[1]);\n            scene.onDisposeObservable.addOnce(() => {\n                scene._ltcTextures?.LTC1.dispose();\n                scene._ltcTextures?.LTC2.dispose();\n            });\n        }\n    })\n        // eslint-disable-next-line github/no-then\n        .catch((error) => {\n        Logger.Error(`Area Light fail to get LTC textures data. Error: ${error}`);\n    });\n}\n/**\n * Abstract Area Light class that servers as parent for all Area Lights implementations.\n * The light is emitted from the area in the -Z direction.\n */\nexport class AreaLight extends Light {\n    /**\n     * Creates a area light object.\n     * Documentation : https://doc.babylonjs.com/features/featuresDeepDive/lights/lights_introduction\n     * @param name The friendly name of the light\n     * @param position The position of the area light.\n     * @param scene The scene the light belongs to\n     */\n    constructor(name, position, scene) {\n        super(name, scene);\n        this.position = position;\n        if (!this._scene._ltcTextures) {\n            CreateSceneLTCTextures(this._scene);\n        }\n    }\n    transferTexturesToEffect(effect) {\n        if (this._scene._ltcTextures) {\n            effect.setTexture(\"areaLightsLTC1Sampler\", this._scene._ltcTextures.LTC1);\n            effect.setTexture(\"areaLightsLTC2Sampler\", this._scene._ltcTextures.LTC2);\n        }\n        return this;\n    }\n    /**\n     * Prepares the list of defines specific to the light type.\n     * @param defines the list of defines\n     * @param lightIndex defines the index of the light for the effect\n     */\n    prepareLightSpecificDefines(defines, lightIndex) {\n        defines[\"AREALIGHT\" + lightIndex] = true;\n        defines[\"AREALIGHTUSED\"] = true;\n    }\n    _isReady() {\n        if (this._scene._ltcTextures) {\n            return this._scene._ltcTextures.LTC1.isReady() && this._scene._ltcTextures.LTC2.isReady();\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=areaLight.js.map","import { Tools } from \"core/Misc/tools\";\n/**\n * Loads LTC texture data from Babylon.js CDN.\n * @returns Promise with data for LTC1 and LTC2 textures for area lights.\n */\nexport async function DecodeLTCTextureDataAsync() {\n    const ltc1 = new Uint16Array(64 * 64 * 4);\n    const ltc2 = new Uint16Array(64 * 64 * 4);\n    const file = await Tools.LoadFileAsync(Tools.GetAssetUrl(\"https://assets.babylonjs.com/core/areaLights/areaLightsLTC.bin\"));\n    const ltcEncoded = new Uint16Array(file);\n    const pixelCount = ltcEncoded.length / 8;\n    for (let pixelIndex = 0; pixelIndex < pixelCount; pixelIndex++) {\n        ltc1[pixelIndex * 4] = ltcEncoded[pixelIndex * 8];\n        ltc1[pixelIndex * 4 + 1] = ltcEncoded[pixelIndex * 8 + 1];\n        ltc1[pixelIndex * 4 + 2] = ltcEncoded[pixelIndex * 8 + 2];\n        ltc1[pixelIndex * 4 + 3] = ltcEncoded[pixelIndex * 8 + 3];\n        ltc2[pixelIndex * 4] = ltcEncoded[pixelIndex * 8 + 4];\n        ltc2[pixelIndex * 4 + 1] = ltcEncoded[pixelIndex * 8 + 5];\n        ltc2[pixelIndex * 4 + 2] = ltcEncoded[pixelIndex * 8 + 6];\n        ltc2[pixelIndex * 4 + 3] = ltcEncoded[pixelIndex * 8 + 7];\n    }\n    return [ltc1, ltc2];\n}\n//# sourceMappingURL=ltcTextureTool.js.map","import { __decorate } from \"tslib\";\nimport { Vector3 } from \"../Maths/math.vector\";\nimport { Node } from \"../node\";\nimport { Light } from \"./light\";\nimport { RegisterClass } from \"core/Misc/typeStore\";\nimport { serialize } from \"../Misc/decorators\";\nimport { AreaLight } from \"./areaLight\";\nNode.AddNodeConstructor(\"Light_Type_4\", (name, scene) => {\n    return () => new RectAreaLight(name, Vector3.Zero(), 1, 1, scene);\n});\n/**\n * A rectangular area light defined by an unique point in world space, a width and a height.\n * The light is emitted from the rectangular area in the -Z direction.\n */\nexport class RectAreaLight extends AreaLight {\n    /**\n     * Rect Area Light width.\n     */\n    get width() {\n        return this._width.x;\n    }\n    /**\n     * Rect Area Light width.\n     */\n    set width(value) {\n        this._width.x = value;\n    }\n    /**\n     * Rect Area Light height.\n     */\n    get height() {\n        return this._height.y;\n    }\n    /**\n     * Rect Area Light height.\n     */\n    set height(value) {\n        this._height.y = value;\n    }\n    /**\n     * Creates a rectangular area light object.\n     * Documentation : https://doc.babylonjs.com/features/featuresDeepDive/lights/lights_introduction\n     * @param name The friendly name of the light\n     * @param position The position of the area light.\n     * @param width The width of the area light.\n     * @param height The height of the area light.\n     * @param scene The scene the light belongs to\n     */\n    constructor(name, position, width, height, scene) {\n        super(name, position, scene);\n        this._width = new Vector3(width, 0, 0);\n        this._height = new Vector3(0, height, 0);\n        this._pointTransformedPosition = Vector3.Zero();\n        this._pointTransformedWidth = Vector3.Zero();\n        this._pointTransformedHeight = Vector3.Zero();\n    }\n    /**\n     * Returns the string \"RectAreaLight\"\n     * @returns the class name\n     */\n    getClassName() {\n        return \"RectAreaLight\";\n    }\n    /**\n     * Returns the integer 4.\n     * @returns The light Type id as a constant defines in Light.LIGHTTYPEID_x\n     */\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    getTypeID() {\n        return Light.LIGHTTYPEID_RECT_AREALIGHT;\n    }\n    _buildUniformLayout() {\n        this._uniformBuffer.addUniform(\"vLightData\", 4);\n        this._uniformBuffer.addUniform(\"vLightDiffuse\", 4);\n        this._uniformBuffer.addUniform(\"vLightSpecular\", 4);\n        this._uniformBuffer.addUniform(\"vLightWidth\", 4);\n        this._uniformBuffer.addUniform(\"vLightHeight\", 4);\n        this._uniformBuffer.addUniform(\"shadowsInfo\", 3);\n        this._uniformBuffer.addUniform(\"depthValues\", 2);\n        this._uniformBuffer.create();\n    }\n    _computeTransformedInformation() {\n        if (this.parent && this.parent.getWorldMatrix) {\n            Vector3.TransformCoordinatesToRef(this.position, this.parent.getWorldMatrix(), this._pointTransformedPosition);\n            Vector3.TransformNormalToRef(this._width, this.parent.getWorldMatrix(), this._pointTransformedWidth);\n            Vector3.TransformNormalToRef(this._height, this.parent.getWorldMatrix(), this._pointTransformedHeight);\n            return true;\n        }\n        return false;\n    }\n    /**\n     * Sets the passed Effect \"effect\" with the PointLight transformed position (or position, if none) and passed name (string).\n     * @param effect The effect to update\n     * @param lightIndex The index of the light in the effect to update\n     * @returns The point light\n     */\n    transferToEffect(effect, lightIndex) {\n        const offset = this._scene.floatingOriginOffset;\n        if (this._computeTransformedInformation()) {\n            this._uniformBuffer.updateFloat4(\"vLightData\", this._pointTransformedPosition.x - offset.x, this._pointTransformedPosition.y - offset.y, this._pointTransformedPosition.z - offset.z, 0, lightIndex);\n            this._uniformBuffer.updateFloat4(\"vLightWidth\", this._pointTransformedWidth.x / 2, this._pointTransformedWidth.y / 2, this._pointTransformedWidth.z / 2, 0, lightIndex);\n            this._uniformBuffer.updateFloat4(\"vLightHeight\", this._pointTransformedHeight.x / 2, this._pointTransformedHeight.y / 2, this._pointTransformedHeight.z / 2, 0, lightIndex);\n        }\n        else {\n            this._uniformBuffer.updateFloat4(\"vLightData\", this.position.x - offset.x, this.position.y - offset.y, this.position.z - offset.z, 0, lightIndex);\n            this._uniformBuffer.updateFloat4(\"vLightWidth\", this._width.x / 2, this._width.y / 2, this._width.z / 2, 0.0, lightIndex);\n            this._uniformBuffer.updateFloat4(\"vLightHeight\", this._height.x / 2, this._height.y / 2, this._height.z / 2, 0.0, lightIndex);\n        }\n        return this;\n    }\n    transferToNodeMaterialEffect(effect, lightDataUniformName) {\n        const offset = this._scene.floatingOriginOffset;\n        if (this._computeTransformedInformation()) {\n            effect.setFloat3(lightDataUniformName, this._pointTransformedPosition.x - offset.x, this._pointTransformedPosition.y - offset.y, this._pointTransformedPosition.z - offset.z);\n        }\n        else {\n            effect.setFloat3(lightDataUniformName, this.position.x - offset.x, this.position.y - offset.y, this.position.z - offset.z);\n        }\n        return this;\n    }\n}\n__decorate([\n    serialize()\n], RectAreaLight.prototype, \"width\", null);\n__decorate([\n    serialize()\n], RectAreaLight.prototype, \"height\", null);\n// Register Class Name\nRegisterClass(\"BABYLON.RectAreaLight\", RectAreaLight);\n//# sourceMappingURL=rectAreaLight.js.map","import { Vector3, Quaternion } from \"core/Maths/math.vector\";\nimport { Color3 } from \"core/Maths/math.color\";\nimport { Light } from \"core/Lights/light\";\nimport { RectAreaLight } from \"core/Lights/rectAreaLight\";\nimport { TransformNode as BabylonTransformNode } from \"core/Meshes/transformNode\";\nimport { GLTFLoader, ArrayItem } from \"../glTFLoader\";\nimport { registerGLTFExtension, unregisterGLTFExtension } from \"../glTFLoaderExtensionRegistry\";\nconst NAME = \"EXT_lights_area\";\n/**\n * [Specification](https://github.com/KhronosGroup/glTF/blob/main/extensions/2.0/Vendor/EXT_lights_area/README.md)\n */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport class EXT_lights_area {\n    /**\n     * @internal\n     */\n    constructor(loader) {\n        /**\n         * The name of this extension.\n         */\n        this.name = NAME;\n        this._loader = loader;\n        this.enabled = this._loader.isExtensionUsed(NAME);\n    }\n    /** @internal */\n    dispose() {\n        this._loader = null;\n        delete this._lights;\n    }\n    /** @internal */\n    onLoading() {\n        const extensions = this._loader.gltf.extensions;\n        if (extensions && extensions[this.name]) {\n            const extension = extensions[this.name];\n            this._lights = extension.lights;\n            ArrayItem.Assign(this._lights);\n        }\n    }\n    /**\n     * @internal\n     */\n    // eslint-disable-next-line no-restricted-syntax\n    loadNodeAsync(context, node, assign) {\n        return GLTFLoader.LoadExtensionAsync(context, node, this.name, async (extensionContext, extension) => {\n            this._loader._allMaterialsDirtyRequired = true;\n            return await this._loader.loadNodeAsync(context, node, (babylonMesh) => {\n                let babylonLight;\n                const light = ArrayItem.Get(extensionContext, this._lights, extension.light);\n                const name = light.name || babylonMesh.name;\n                this._loader.babylonScene._blockEntityCollection = !!this._loader._assetContainer;\n                const size = light.size !== undefined ? light.size : 1.0;\n                switch (light.type) {\n                    case \"rect\" /* EXTLightsArea_LightType.RECT */: {\n                        const width = light.rect?.aspect !== undefined ? light.rect.aspect * size : size;\n                        const height = size;\n                        const babylonRectAreaLight = new RectAreaLight(name, Vector3.Zero(), width, height, this._loader.babylonScene);\n                        babylonLight = babylonRectAreaLight;\n                        break;\n                    }\n                    case \"disk\" /* EXTLightsArea_LightType.DISK */: {\n                        // For disk lights, we'll use a rectangle light with the same area to approximate the disk light\n                        // In the future, this could be extended to support actual disk area lights\n                        const newSize = Math.sqrt(size * size * 0.25 * Math.PI); // Area of the disk\n                        const babylonRectAreaLight = new RectAreaLight(name, Vector3.Zero(), newSize, newSize, this._loader.babylonScene);\n                        babylonLight = babylonRectAreaLight;\n                        break;\n                    }\n                    default: {\n                        this._loader.babylonScene._blockEntityCollection = false;\n                        throw new Error(`${extensionContext}: Invalid area light type (${light.type})`);\n                    }\n                }\n                babylonLight._parentContainer = this._loader._assetContainer;\n                this._loader.babylonScene._blockEntityCollection = false;\n                light._babylonLight = babylonLight;\n                babylonLight.falloffType = Light.FALLOFF_GLTF;\n                babylonLight.diffuse = light.color ? Color3.FromArray(light.color) : Color3.White();\n                babylonLight.intensity = light.intensity == undefined ? 1 : light.intensity;\n                // glTF EXT_lights_area specifies lights face down -Z, but Babylon.js area lights face down +Z\n                // Create a parent transform node with 180-degree rotation around Y axis to flip the direction\n                const lightParentNode = new BabylonTransformNode(`${name}_orientation`, this._loader.babylonScene);\n                lightParentNode.rotationQuaternion = Quaternion.RotationAxis(Vector3.Up(), Math.PI);\n                lightParentNode.parent = babylonMesh;\n                babylonLight.parent = lightParentNode;\n                this._loader._babylonLights.push(babylonLight);\n                GLTFLoader.AddPointerMetadata(babylonLight, extensionContext);\n                assign(babylonMesh);\n            });\n        });\n    }\n}\nunregisterGLTFExtension(NAME);\nregisterGLTFExtension(NAME, true, (loader) => new EXT_lights_area(loader));\n//# sourceMappingURL=EXT_lights_area.js.map"],"names":["CreateSceneLTCTextures","scene","useDelayedTextureLoading","previousState","_blockEntityCollection","_ltcTextures","LTC1","RawTexture","CreateRGBATexture","getEngine","Constants","TEXTURE_LINEAR_LINEAR","TEXTURETYPE_HALF_FLOAT","LTC2","wrapU","Texture","CLAMP_ADDRESSMODE","wrapV","async","ltc1","Uint16Array","ltc2","file","Tools","LoadFileAsync","GetAssetUrl","ltcEncoded","pixelCount","length","pixelIndex","DecodeLTCTextureDataAsync","then","textureData","update","onDisposeObservable","addOnce","dispose","catch","error","Logger","Error","AreaLight","Light","constructor","name","position","super","this","_scene","transferTexturesToEffect","effect","setTexture","prepareLightSpecificDefines","defines","lightIndex","_isReady","isReady","Node","AddNodeConstructor","RectAreaLight","Vector3","Zero","width","_width","x","value","height","_height","y","_pointTransformedPosition","_pointTransformedWidth","_pointTransformedHeight","getClassName","getTypeID","LIGHTTYPEID_RECT_AREALIGHT","_buildUniformLayout","_uniformBuffer","addUniform","create","_computeTransformedInformation","parent","getWorldMatrix","TransformCoordinatesToRef","TransformNormalToRef","transferToEffect","offset","floatingOriginOffset","updateFloat4","z","transferToNodeMaterialEffect","lightDataUniformName","setFloat3","__decorate","serialize","prototype","RegisterClass","NAME","EXT_lights_area","loader","_loader","enabled","isExtensionUsed","_lights","onLoading","extensions","gltf","extension","lights","ArrayItem","Assign","loadNodeAsync","context","node","assign","GLTFLoader","LoadExtensionAsync","extensionContext","_allMaterialsDirtyRequired","babylonMesh","babylonLight","light","Get","babylonScene","_assetContainer","size","undefined","type","rect","aspect","newSize","Math","sqrt","PI","_parentContainer","_babylonLight","falloffType","FALLOFF_GLTF","diffuse","color","Color3","FromArray","White","intensity","lightParentNode","BabylonTransformNode","rotationQuaternion","Quaternion","RotationAxis","Up","_babylonLights","push","AddPointerMetadata","unregisterGLTFExtension","registerGLTFExtension"],"mappings":"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"}